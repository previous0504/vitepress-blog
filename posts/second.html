<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue3学习笔记 | Tao's blog</title>
    <meta name="description" content="跟着b站小满zs学习vue3">
    <link rel="stylesheet" href="/vitepress-blog/assets/style.f398cb37.css">
    <link rel="modulepreload" href="/vitepress-blog/assets/Home.453b9f11.js">
    <link rel="modulepreload" href="/vitepress-blog/assets/app.4138e7bc.js">
    <link rel="modulepreload" href="/vitepress-blog/assets/posts_second.md.264a8a63.lean.js">
    <link rel="modulepreload" href="/vitepress-blog/assets/app.4138e7bc.js">
    <meta name="twitter:title" content="vue3学习笔记 | Tao&#39;s blog">
    <meta property="og:title" content="vue3学习笔记 | Tao&#39;s blog">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-40587210><div class="sidebar-button" data-v-40587210><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/vitepress-blog/" aria-label="Tao&#39;s blog, back to home" data-v-40587210 data-v-7ac13a1e><img class="logo" src="/vitepress-blog/favicon.ico" alt="Logo" data-v-7ac13a1e> Tao&#39;s blog</a><div class="flex-grow" data-v-40587210></div><div class="nav" data-v-40587210><nav class="nav-links" data-v-40587210 data-v-35b91e7e><!--[--><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/vitepress-blog/" data-v-49fe041d>首页 <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/vitepress-blog/pages/docs" data-v-49fe041d>归档 <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/vitepress-blog/pages/tags" data-v-49fe041d>标签 <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/vitepress-blog/pages/about" data-v-49fe041d>关于 <!----></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-17c48e2f><nav class="nav-links nav" data-v-17c48e2f data-v-35b91e7e><!--[--><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/vitepress-blog/" data-v-49fe041d>首页 <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/vitepress-blog/pages/docs" data-v-49fe041d>归档 <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/vitepress-blog/pages/tags" data-v-49fe041d>标签 <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/vitepress-blog/pages/about" data-v-49fe041d>关于 <!----></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-17c48e2f><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="#npm-run-dev详解">npm run dev详解</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#虚拟dom、diff算法">虚拟dom、diff算法</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#_1-无key的时候">1.无key的时候</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_2-有key的时候">2.有key的时候</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#响应式原理">响应式原理</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#ref">Ref</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#reactive">Reactive</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#computed">Computed</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#watch">Watch</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#生命周期">生命周期</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#onbeforemount">onBeforeMount()</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#onmounted">onMounted()</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#onbeforeupdate">onBeforeUpdate()</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#onupdated">onUpdated()</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#onbeforeunmount">onBeforeUnmount()</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#onunmounted">onUnmounted()</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#父子组件传参">父子组件传参</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#defineprops">defineProps</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#defineemits">defineEmits</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#ref-defineexpose">ref (defineExpose)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#案例-封装瀑布流事件">案例(封装瀑布流事件)</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-8fcebc32><div class="container" data-v-8fcebc32><!--[--><!--]--><div style="position:relative;" class="content" data-v-8fcebc32><div><h1 id="介绍vue" tabindex="-1">介绍vue <a class="header-anchor" href="#介绍vue" aria-hidden="true">#</a></h1><p>vue使用了MVVM(Model-View-ViewModel) 架构</p><p>1.view:视图层(UI用户界面)</p><p>2.viewModel:业务逻辑层(一切js可视为业务逻辑)</p><p>3.model:数据层(存储数据及对数据的处理如增删改查)</p><p><img src="/vitepress-blog/imgs/mvvm.png" alt="image"></p><h2 id="npm-run-dev详解" tabindex="-1">npm run dev详解 <a class="header-anchor" href="#npm-run-dev详解" aria-hidden="true">#</a></h2><p>先从本地的node_modules中查找.bin文件夹里找有没有vite可以执行，如果没有，会去全局找，全局没有的话会去找环境变量，环境变量没有的话会报错。</p><h2 id="虚拟dom、diff算法" tabindex="-1">虚拟dom、diff算法 <a class="header-anchor" href="#虚拟dom、diff算法" aria-hidden="true">#</a></h2><ul><li>使用AST静态节点🌲来代替dom节点</li></ul><h3 id="_1-无key的时候" tabindex="-1">1.无key的时候 <a class="header-anchor" href="#_1-无key的时候" aria-hidden="true">#</a></h3><p><img src="/vitepress-blog/imgs/nokey.png" alt="image"></p><h3 id="_2-有key的时候" tabindex="-1">2.有key的时候 <a class="header-anchor" href="#_2-有key的时候" aria-hidden="true">#</a></h3><p><img src="/vitepress-blog/imgs/haskey.png" alt="image"></p><p>最长递增子序列 * leetcode-300</p><p><a href="https://leetcode.cn/problems/longest-increasing-subsequence/" target="_blank" rel="noopener noreferrer">https://leetcode.cn/problems/longest-increasing-subsequence/</a></p><p>1.动态规划(Dp)，时间复杂度O(n)²</p><div class="language-javascript"><pre><code> <span class="token operator">*</span><span class="token operator">/</span>
<span class="token keyword">var</span> <span class="token function-variable function">lengthOfLIS</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">nums</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">let</span> dp <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span> length<span class="token operator">:</span> nums<span class="token punctuation">.</span>length <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>dp<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
                
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">...</span>dp<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>2.贪心算法+二分法查找</p><div class="language-javascript"><pre><code><span class="token keyword">var</span> <span class="token function-variable function">lengthOfLIS</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">nums</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span>nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果当前数值大于已选结果的最后一位，则直接往后新增，若当前数值更小，则直接替换前面第一个大于它的数值</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> result<span class="token punctuation">[</span>result<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>result<span class="token punctuation">.</span>length<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 二分查找：找到第一个大于当前数值的结果进行替换</span>
            <span class="token keyword">let</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> result<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> middle <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">[</span>middle<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    left <span class="token operator">=</span> middle <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    right <span class="token operator">=</span> middle<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 替换当前下标</span>
            result<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="响应式原理" tabindex="-1">响应式原理 <a class="header-anchor" href="#响应式原理" aria-hidden="true">#</a></h2><p>未完待续……</p><h3 id="ref" tabindex="-1">Ref <a class="header-anchor" href="#ref" aria-hidden="true">#</a></h3><ul><li><p><strong>ref</strong>，接受一个内部值，返回一个响应式、可更改的ref对象，只有一个指向其内部值的属性.value</p></li><li><p><strong>isRef</strong>，检测某个值是否为ref</p></li><li><p><strong>toRef</strong>，基于响应式对象上的一个属性，创建一个对应的 ref。这样创建的 ref 与其源属性保持同步：改变源属性的值将更新 ref 的值，反之亦然。</p><div class="language-javascript"><pre><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  bar<span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> fooRef <span class="token operator">=</span> <span class="token function">toRef</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token string">&#39;foo&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// 更改该 ref 会更新源属性</span>
fooRef<span class="token punctuation">.</span>value<span class="token operator">++</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>foo<span class="token punctuation">)</span> <span class="token comment">// 2</span>

<span class="token comment">// 更改源属性也会更新该 ref</span>
state<span class="token punctuation">.</span>foo<span class="token operator">++</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fooRef<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 3</span>

</code></pre></div></li><li><p><strong>toRefs</strong></p><div class="language-javascript"><pre><code><span class="token keyword">function</span> <span class="token function">useFeatureX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    foo<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    bar<span class="token operator">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// ...基于状态的操作逻辑</span>

  <span class="token comment">// 在返回时都转为 ref</span>
  <span class="token keyword">return</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 可以解构而不会失去响应性</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> foo<span class="token punctuation">,</span> bar <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFeatureX</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li><li><p><strong>shallowRef</strong> 浅层的响应式 可用<strong>triggerRef</strong> 强制触发依赖于一个<a href="https://cn.vuejs.org/api/reactivity-advanced.html#shallowref" target="_blank" rel="noopener noreferrer">浅层 ref</a> 的副作用</p><div class="language-javascript"><pre><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">shallowRef</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 不会触发更改</span>
state<span class="token punctuation">.</span>value<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">2</span>

<span class="token comment">// 会触发更改</span>
state<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
</code></pre></div></li><li><p>**customRef ** 自定义的ref，可以加入防抖等功能</p></li></ul><h3 id="reactive" tabindex="-1">Reactive <a class="header-anchor" href="#reactive" aria-hidden="true">#</a></h3><ul><li><p>reactive 返回一个对象的响应式代理</p></li><li><p>shallowReactive</p></li><li><p>toRaw 返回原始对象</p></li></ul><h3 id="computed" tabindex="-1">Computed <a class="header-anchor" href="#computed" aria-hidden="true">#</a></h3><div class="language-javascript"><pre><code><span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> plusOne <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count<span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    count<span class="token punctuation">.</span>value <span class="token operator">=</span> val <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

plusOne<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 0</span>
</code></pre></div><h3 id="watch" tabindex="-1">Watch <a class="header-anchor" href="#watch" aria-hidden="true">#</a></h3><ul><li><strong>watch</strong></li></ul><div class="language-javascript"><pre><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 监听一个getter函数</span>
<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>count<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">count<span class="token punctuation">,</span> prevCount</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/* ... */</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token comment">// 监听多个值</span>
<span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span>fooRef<span class="token punctuation">,</span> barRef<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>foo<span class="token punctuation">,</span> bar<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>prevFoo<span class="token punctuation">,</span> prevBar<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><p><strong>watchEffect</strong> 默认immediate:true，无需指定属性</p><div class="language-javascript"><pre><code><span class="token keyword">const</span> stop <span class="token operator">=</span> <span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">effect</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> ipt<span class="token operator">:</span>HTMLInputElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#ipt&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLInputElement
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ipt<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message1<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;before&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
 
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  flush<span class="token operator">:</span><span class="token string">&#39;post&#39;</span><span class="token comment">//在dom渲染之后调用，默认为pre</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul><h2 id="生命周期" tabindex="-1">生命周期 <a class="header-anchor" href="#生命周期" aria-hidden="true">#</a></h2><p>一个组件从创建到销毁的过程称为生命周期</p><p>vue3的组合式api(setup)是没有 beforeCreate 和 created 生命周期的</p><h3 id="onbeforemount" tabindex="-1">onBeforeMount() <a class="header-anchor" href="#onbeforemount" aria-hidden="true">#</a></h3><p>在组件DOM实际渲染安装之前调用，根元素还不存在</p><h3 id="onmounted" tabindex="-1">onMounted() <a class="header-anchor" href="#onmounted" aria-hidden="true">#</a></h3><p>在组件的第一次渲染后调用，允许直接DOM访问</p><h3 id="onbeforeupdate" tabindex="-1">onBeforeUpdate() <a class="header-anchor" href="#onbeforeupdate" aria-hidden="true">#</a></h3><p>数据更新时调用，发生在虚拟DOM打补丁之前</p><h3 id="onupdated" tabindex="-1">onUpdated() <a class="header-anchor" href="#onupdated" aria-hidden="true">#</a></h3><p>DOM更新后，updated的方法即会调用</p><h3 id="onbeforeunmount" tabindex="-1">onBeforeUnmount() <a class="header-anchor" href="#onbeforeunmount" aria-hidden="true">#</a></h3><p>在卸载组件实例之前调用</p><h3 id="onunmounted" tabindex="-1">onUnmounted() <a class="header-anchor" href="#onunmounted" aria-hidden="true">#</a></h3><p>卸载组件实例后调用，调用此钩子所有指令都被解除绑定，所有时间侦听器都被移除，所有子组件实例被卸载</p><h2 id="父子组件传参" tabindex="-1">父子组件传参 <a class="header-anchor" href="#父子组件传参" aria-hidden="true">#</a></h2><h3 id="defineprops" tabindex="-1">defineProps <a class="header-anchor" href="#defineprops" aria-hidden="true">#</a></h3><p><strong>defineProps</strong>-子组件接收父组件的值</p><div class="language-javascript"><pre><code><span class="token comment">// js</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span>String<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token string">&#39;&#39;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//ts withDefaults(ts特有的)</span>
<span class="token keyword">const</span> props1 <span class="token operator">=</span> <span class="token function">withDefaults</span><span class="token punctuation">(</span>defineProps<span class="token operator">&lt;</span><span class="token punctuation">{</span>
    data<span class="token operator">:</span>string
<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    data<span class="token operator">:</span><span class="token string">&#39;xxx&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="defineemits" tabindex="-1">defineEmits <a class="header-anchor" href="#defineemits" aria-hidden="true">#</a></h3><p><strong>defineEmits</strong>-父组件接收子组件的值</p><div class="language-javascript"><pre><code><span class="token keyword">const</span> obj <span class="token operator">=</span> reactive<span class="token operator">&lt;</span>number<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">//js </span>
<span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;on-click&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">//ts</span>
<span class="token keyword">const</span> emit <span class="token operator">=</span> defineEmits<span class="token operator">&lt;</span><span class="token punctuation">{</span>
    <span class="token punctuation">(</span>e<span class="token operator">:</span><span class="token string">&#39;on-click&#39;</span><span class="token punctuation">,</span>obj<span class="token operator">:</span>number<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">void</span>
<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">clickTap</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;on-click&#39;</span><span class="token punctuation">,</span>obj<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ref-defineexpose" tabindex="-1">ref (defineExpose) <a class="header-anchor" href="#ref-defineexpose" aria-hidden="true">#</a></h3><p><strong>ref</strong> -父组件使用子组件的值或者方法</p><div class="language-javascript"><pre><code><span class="token comment">// 父组件代码</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span><span class="token constant">A</span> ref<span class="token operator">=</span><span class="token string">&quot;child&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token constant">A</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">const</span> child <span class="token operator">=</span> ref<span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> <span class="token constant">A</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token comment">// 子组件代码</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> reactive<span class="token operator">&lt;</span>number<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&#39;123&#39;</span><span class="token punctuation">)</span>

<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    obj<span class="token punctuation">,</span>
    name
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="案例-封装瀑布流事件" tabindex="-1">案例(封装瀑布流事件) <a class="header-anchor" href="#案例-封装瀑布流事件" aria-hidden="true">#</a></h3><p>使用js来实现绝对定位,具体代码如下</p><div class="language-javascript"><pre><code>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 瀑布流案例 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;wraps&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">&quot;{height:item.height+&#39;px&#39;,background:item.background,top:item.top+&#39;px&#39;,left:item.left + &#39;px&#39;}&quot;</span>
            v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in waterList&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;items&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> onMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;list&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> waterList <span class="token operator">=</span> reactive<span class="token operator">&lt;</span>any<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 存储高度</span>
    <span class="token keyword">const</span> heightList<span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token number">130</span>
    <span class="token comment">// clientWidth元素的宽度，包含padding</span>
    <span class="token keyword">const</span> x <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth

    <span class="token comment">// 计算出一列放几条数据</span>
    <span class="token keyword">const</span> column <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>x <span class="token operator">/</span> width<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> props<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> column<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            props<span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
            props<span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>left <span class="token operator">=</span> i <span class="token operator">*</span> width<span class="token punctuation">;</span>
            heightList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>height <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span>
            waterList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> current <span class="token operator">=</span> heightList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token comment">// 找出第一行最小的高度</span>
            heightList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">h<span class="token punctuation">,</span> inx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">&gt;</span> h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    current <span class="token operator">=</span> h<span class="token punctuation">;</span>
                    index <span class="token operator">=</span> inx<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            props<span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token punctuation">(</span>current <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            props<span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>left <span class="token operator">=</span> index <span class="token operator">*</span> width<span class="token punctuation">;</span>
            <span class="token comment">// 拼装第二行的高度</span>
            heightList<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span>  <span class="token punctuation">(</span>heightList<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">+</span> props<span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>height <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            waterList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onresize</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style <span class="token operator">&gt;</span>
<span class="token punctuation">.</span>wraps <span class="token punctuation">{</span>
    position<span class="token operator">:</span> relative<span class="token punctuation">;</span>
    width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    height<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token punctuation">.</span>items <span class="token punctuation">{</span>
    position<span class="token operator">:</span> absolute<span class="token punctuation">;</span>
    width<span class="token operator">:</span> <span class="token number">120</span>px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>

</code></pre></div></div></div><footer class="page-footer" data-v-8fcebc32 data-v-5c96fb00><div class="edit" data-v-5c96fb00><div class="edit-link" data-v-5c96fb00 data-v-55695e90><!----></div></div><div class="updated" data-v-5c96fb00><!----></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"d78991b8\",\"pages_about.md\":\"be8e12d4\",\"pages_docs.md\":\"f8a46122\",\"pages_tags.md\":\"29999ec6\",\"posts_first.md\":\"ca1d9155\",\"posts_second.md\":\"264a8a63\",\"posts_third.md\":\"1ec28bd1\"}")</script>
    <script type="module" async src="/vitepress-blog/assets/app.4138e7bc.js"></script>
    
  </body>
</html>